<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:d="http://xamarin.com/schemas/2014/forms/design"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             mc:Ignorable="d"
             Title=""  BackgroundColor="{AppThemeBinding Light=#F9F9F9, Dark=#121212}"
             Shell.NavBarIsVisible="True"
             x:Class="MRWMO.Content">
    <ContentPage.ToolbarItems>
        <ToolbarItem Clicked="ToggleSettings_Clicked" Text="Settings" IconImageSource="ic_action_settings.png" Order="Primary" Priority="0" />
    </ContentPage.ToolbarItems>

    <Grid>
        <ScrollView>
            <VerticalStackLayout Padding="20,20,20,120" Spacing="20">
                <!-- Adjusted bottom padding for the new panel height -->
                <VerticalStackLayout.GestureRecognizers>
                    <TapGestureRecognizer Tapped="OnContentTapped" />
                </VerticalStackLayout.GestureRecognizers>

                <!-- Header -->
                <Grid ColumnDefinitions="*,Auto" VerticalOptions="Center">
                    <Label Text="{Binding Name}"
                           FontSize="22"
                           FontAttributes="Bold"
                           FontFamily="AbhayaLibreM"
                           HorizontalTextAlignment="Center"
                           TextColor="{AppThemeBinding Light=#222, Dark=#F0F0F0}" />
                </Grid>

                <!-- Chapter Content -->
                <Label x:Name="contents"
                       Text="{Binding Content}"
                       FontSize="13"
                       TextColor="{AppThemeBinding Light=#444, Dark=#FAF9F6 }"
                       FontFamily=""
                       LineHeight="1.3"
                       HorizontalTextAlignment="Justify" />

            </VerticalStackLayout>
        </ScrollView>

        <!-- Modern Bottom Sheet Settings Panel -->
        <Border x:Name="SettingsPanel"
                IsVisible="False"
                VerticalOptions="End"
                Margin="10"
                Padding="10"
                Stroke="{AppThemeBinding Light=#E0E0E0, Dark=#444444}"
                BackgroundColor="{AppThemeBinding Light=#FFFFFF, Dark=#282828}"
                StrokeThickness="1">
            <Border.StrokeShape>
                <RoundRectangle CornerRadius="20" />
            </Border.StrokeShape>
            <Border.Shadow>
                <Shadow Brush="#000" Offset="0,10" Radius="20" Opacity="0.1" />
            </Border.Shadow>

            <!-- Replaced FlexLayout with a Grid for precise control over layout -->
            <Grid RowSpacing="15" ColumnSpacing="10">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>

                <!-- Theme Button -->
                <VerticalStackLayout Grid.Row="0" Grid.Column="0" Spacing="5" Padding="5">
                    <VerticalStackLayout.GestureRecognizers>
                        <TapGestureRecognizer Tapped="ToggleDarkMode_Clicked"/>
                    </VerticalStackLayout.GestureRecognizers>
                    <Image HeightRequest="24" WidthRequest="24" HorizontalOptions="Center">
                        <Image.Source>
                            <AppThemeBinding Light="ic_action_dark_mode_black.png" Dark="ic_action_dark_mode.png" />
                        </Image.Source>
                    </Image>
                    <Label Text="Theme" FontSize="10" HorizontalOptions="Center" TextColor="{AppThemeBinding Light=#555, Dark=#DDD}" />
                </VerticalStackLayout>

                <!-- Zoom In Button -->
                <VerticalStackLayout Grid.Row="0" Grid.Column="1" Spacing="5" Padding="5">
                    <VerticalStackLayout.GestureRecognizers>
                        <TapGestureRecognizer Tapped="ToolbarItem_Clicked_Plus"/>
                    </VerticalStackLayout.GestureRecognizers>
                    <Image HeightRequest="24" WidthRequest="24" HorizontalOptions="Center">
                        <Image.Source>
                            <AppThemeBinding Light="ic_action_zoom_in_black.png" Dark="ic_action_zoom_in.png" />
                        </Image.Source>
                    </Image>
                    <Label Text="Zoom In" FontSize="10" HorizontalOptions="Center" TextColor="{AppThemeBinding Light=#555, Dark=#DDD}" />
                </VerticalStackLayout>

                <!-- Zoom Out Button -->
                <VerticalStackLayout Grid.Row="0" Grid.Column="2" Spacing="5" Padding="5">
                    <VerticalStackLayout.GestureRecognizers>
                        <TapGestureRecognizer Tapped="ToolbarItem_Clicked_Minus"/>
                    </VerticalStackLayout.GestureRecognizers>
                    <Image HeightRequest="24" WidthRequest="24" HorizontalOptions="Center">
                        <Image.Source>
                            <AppThemeBinding Light="ic_action_zoom_out_black.png" Dark="ic_action_zoom_out.png" />
                        </Image.Source>
                    </Image>
                    <Label Text="Zoom Out" FontSize="10" HorizontalOptions="Center" TextColor="{AppThemeBinding Light=#555, Dark=#DDD}" />
                </VerticalStackLayout>

                <!-- Bookmark Button -->
                <VerticalStackLayout Grid.Row="0" Grid.Column="3" Spacing="5" Padding="5">
                    <VerticalStackLayout.GestureRecognizers>
                        <TapGestureRecognizer Tapped="ToolbarItem_Clicked_BookMark"/>
                    </VerticalStackLayout.GestureRecognizers>
                    <Image x:Name="BookMarkToolBarItem" HeightRequest="24" WidthRequest="24" HorizontalOptions="Center">
                        <Image.Source>
                            <AppThemeBinding Light="ic_action_bookmark_border_black.png" Dark="ic_action_bookmark_border.png" />
                        </Image.Source>
                    </Image>
                    <Label Text="Bookmark" FontSize="10" HorizontalOptions="Center" TextColor="{AppThemeBinding Light=#555, Dark=#DDD}" />
                </VerticalStackLayout>

                <!-- Previous Button -->
                <VerticalStackLayout Grid.Row="1" Grid.Column="0" Spacing="5" Padding="5">
                    <VerticalStackLayout.GestureRecognizers>
                        <TapGestureRecognizer Tapped="ToolbarItem_Clicked_Back"/>
                    </VerticalStackLayout.GestureRecognizers>
                    <Image HeightRequest="24" WidthRequest="24" HorizontalOptions="Center">
                        <Image.Source>
                            <AppThemeBinding Light="ic_action_skip_previous_black.png" Dark="ic_action_skip_previous.png" />
                        </Image.Source>
                    </Image>
                    <Label Text="Previous" FontSize="10" HorizontalOptions="Center" TextColor="{AppThemeBinding Light=#555, Dark=#DDD}" />
                </VerticalStackLayout>

                <!-- Next Button -->
                <VerticalStackLayout Grid.Row="1" Grid.Column="1" Spacing="5" Padding="5">
                    <VerticalStackLayout.GestureRecognizers>
                        <TapGestureRecognizer Tapped="ToolbarItem_Clicked_Next"/>
                    </VerticalStackLayout.GestureRecognizers>
                    <Image HeightRequest="24" WidthRequest="24" HorizontalOptions="Center">
                        <Image.Source>
                            <AppThemeBinding Light="ic_action_skip_next_black.png" Dark="ic_action_skip_next.png" />
                        </Image.Source>
                    </Image>
                    <Label Text="Next" FontSize="10" HorizontalOptions="Center" TextColor="{AppThemeBinding Light=#555, Dark=#DDD}" />
                </VerticalStackLayout>

                <!-- Play Button -->
                <VerticalStackLayout Grid.Row="1" Grid.Column="2" Spacing="5" Padding="5">
                    <VerticalStackLayout.GestureRecognizers>
                        <TapGestureRecognizer Tapped="PlayToolBarItem_Clicked"/>
                    </VerticalStackLayout.GestureRecognizers>
                    <Image x:Name="PlayToolBarItem" HeightRequest="24" WidthRequest="24" HorizontalOptions="Center">
                        <Image.Source>
                            <AppThemeBinding Light="ic_action_play_arrow_black.png" Dark="ic_action_play_arrow.png" />
                        </Image.Source>
                    </Image>
                    <Label Text="Play" FontSize="10" HorizontalOptions="Center" TextColor="{AppThemeBinding Light=#555, Dark=#DDD}" />
                </VerticalStackLayout>

                <!-- Share Button -->
                <VerticalStackLayout Grid.Row="1" Grid.Column="3" Spacing="5" Padding="5">
                    <VerticalStackLayout.GestureRecognizers>
                        <TapGestureRecognizer Tapped="ShareToolBarItem_Clicked"/>
                    </VerticalStackLayout.GestureRecognizers>
                    <Image x:Name="ShareToolBarItem" HeightRequest="24" WidthRequest="24" HorizontalOptions="Center">
                        <Image.Source>
                            <AppThemeBinding Light="ic_action_share_black.png" Dark="ic_action_share.png" />
                        </Image.Source>
                    </Image>
                    <Label Text="Share" FontSize="10" HorizontalOptions="Center" TextColor="{AppThemeBinding Light=#555, Dark=#DDD}" />
                </VerticalStackLayout>

            </Grid>
        </Border>
    </Grid>
</ContentPage>